<!DOCTYPE html>
<html>
<head>
  <title>Issues</title>
  <style>
    {% include 'css/styles.css' %}
  </style>
  <style>
    {% include 'css/tailwind.min.css' %}
  </style>
</head>
<body>
  <div page>
    <h1 title >Issues</h1>
    <form action="">
      <div search>

        <input search name="filters" value="{{previous_filters}}" type="text">

        <button search type="submit">Search</button>
      </div>

      <div container>

            <!-- <input hidden name="previous_filters" value="{{previous_filters}}" type="text"> -->
            <ul header><!-- Begin header-->
              {% set pos_left = true -%}
              {% set searchable = true -%}
              {% set col_name = "title" -%}
              {% set col_field = "title" -%}
              {% include "chunks/column_header.html" %}

              <div body_cell>
                {% set pos_left = false -%}
                {% set searchable = true -%}
                {% set col_name = "Body + Comments" -%}
                {% set col_field = "body" -%}
                {% include "chunks/column_header.html" %}

                {% set searchable = false -%}
              </div>

              {% for key,tag in all_tags %}
                {% if (loop.index - 1) % 3 == 0 or loop.index == 1 %}
                  {% if loop.index > 1  %}
                    </div>
                  {% endif %}
                  <div three_cell_group >
                {% endif %}
                
                {% set col_name = tag.name %}
                {% set col_options = tag.values %}
                {% set col_index = loop.index %}
                {% include "chunks/column_header.html" %}

                {% if loop.last %}
                  </div>
                {% endif %}
              {% endfor %}
              <li cell_header>
                <button filter_search type="submit">
                  Submit search
                </button>
    
              </li>
            </ul> <!-- End header-->
          
        <!-- Rows below -->
        {% if issues[0] %}
          {% for issue in issues %}
            {# to give different color depending of the row number#}
            {% if loop.index % 2 == 0 %}
            <article pair_row  >

            {% else %}
            <article odd_row  >

            {% endif %}
              <div cell data_label="Title">
                <a title_issue href="{{issue.html_url}}" target="_blank">{{ issue.title }}</a><!-- Title  -->
              </div>

              <div body_cell >
                <div cell  data_label="Body">
                {% if issue.body %}
                  <p body> {{ issue.min_body }} </p> <!-- Body  -->
                  {% set issue = issue %}
                  {% include "chunks/comments_modal.html" %}
                {% endif %}

                </div>
              </div>
              {% for key,tag in all_tags %}
                {% if (loop.index - 1) % 3 == 0 or loop.index == 1 %}
                  {% if loop.index > 1  %}
                    </div>
                  {% endif %}
                  <div three_cell_group >
                {% endif %}

                <div cell data_label="{{tag.name | capitalize }}">
                  {% if issue.tags[tag.name] %}
                    <strong>{{issue.tags[tag.name]}}</strong>
                  {% else %}
                    <strong>----</strong>
                  {% endif %}
                </div>
                {% if loop.last %}
                  </div>
                {% endif %}
              {% endfor %}
            </article>
          {% endfor %}
        {% endif %}
      </div>
    </form>

  </div>

</body>
</html>